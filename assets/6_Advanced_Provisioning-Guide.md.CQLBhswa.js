import{_ as t,c as a,o as s,ag as i}from"./chunks/framework.BRQrZDXk.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"6_Advanced/Provisioning-Guide.md","filePath":"6_Advanced/Provisioning-Guide.md"}'),n={name:"6_Advanced/Provisioning-Guide.md"};function o(r,e,p,d,l,c){return s(),a("div",null,e[0]||(e[0]=[i(`<p>See <a href="https://github.com/internetarchive/openlibrary/issues/2036" target="_blank" rel="noreferrer">#2036 Migrate all production VMs to Ubuntu Focal</a></p><p>Updating configuration and services has happened a lot less frequently than basic code deployments. The following instructions apply to the less frequent updates that may coincide with code releases. Extra caution is required when updating production configuration and servers since there is not yet a reliable, repeatable process for performing these tasks. They are currently manual steps. We will work on automating these initial deploys with tools like Ansible and Docker where appropriate.</p><p>Required OS upgrades (upgrading all our server from Ubuntu Trusty to Ubuntu Focal, which are required by the end of 2019), will be performed at some point in 2019 for all OL servers and services. We have decided to start with Memcached since it is theoretically the simplest to upgrade, and there is a pool of multiple servers that can have one swapped out with an upgrade with minimal effect (or so the theory goes).</p><h2 id="steps-to-perform-when-making-the-upgrade" tabindex="-1">Steps to perform when making the upgrade <a class="header-anchor" href="#steps-to-perform-when-making-the-upgrade" aria-label="Permalink to &quot;Steps to perform when making the upgrade&quot;">​</a></h2><ul><li><p>ssh to the new server (from e.g. ol-home0) to verify that the host is accessible, and is the expected host with the expected operating system for Ubuntu: <code>lsb_release -a</code></p></li><li><p>Test that the new memcached server is up and responsive (memcached telnet command to verify the memcache server is accepting connections and is at the expected version, check memory and utilization stats)</p></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>telnet ol-mem4 11211</span></span>
<span class="line"><span></span></span>
<span class="line"><span>version</span></span>
<span class="line"><span>stats</span></span>
<span class="line"><span>stats items</span></span>
<span class="line"><span>quit</span></span></code></pre></div><ul><li>ensure the memcache pool configuration is updated and <em>loaded</em> for both Open Library <em>and</em> Infobase. Update and restart the appropriate services.</li></ul><h2 id="post-upgrade-testing" tabindex="-1">Post upgrade testing <a class="header-anchor" href="#post-upgrade-testing" aria-label="Permalink to &quot;Post upgrade testing&quot;">​</a></h2><ul><li><p>Make a test edit to an Open Library item and confirm the record is updated as expected, and the edit history is current and shows the correct difference, with an appropriately incremented version number.</p></li><li><p>Monitor community edits post-upgrade over a period of a few days to look for any unexpected behavior. Since there is a pool (some edits may be cached correctly while some have problems), and caching issues may take some time to manifest, proving a single edit looks good is not sufficient to indicate an all-clear. Multiple edits should be checked daily to rule out the possibility of less obvious issues. Check a range of data types. Editions, Works, Authors, Lists, Newly added items, etc.</p></li><li><p>Place a notification in the <code>#openlibrary-g</code> channel to notify the community that a change has been made, and ask for anyone who notices anything unusual with regards to editing changes being saved to speak out in the channel and contact @mek or @charles.</p></li></ul>`,9)]))}const m=t(n,[["render",o]]);export{u as __pageData,m as default};
